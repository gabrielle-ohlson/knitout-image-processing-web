
<!DOCTYPE html>
<html lang="en">
<head>
    <script src='/src/utils/draw.js' type="text/javascript"></script>
    <title>Document</title>
		<style>
			#motif {
				height: auto;
				width: auto;
			}

			.imageWrapper {
				position: relative;
			}

			.overlayImage {
				position: absolute;
				top: 0;
				left: 0;
			}
		</style>
</head>
<body>
	<div class="imageWrapper">
		<% if (motifPath) { %>
			<img id="motif" class="overlayImage" src="<%= motifPath %>">
		<% } %>
		<div id="canvas-container" class="overlayImage"></div>
	</div>
	<div style="display:none">
		<% if (picPath) { %>
			<img id="pic" src="<%=picPath%>">
		<% } %>
	</div>
</body>
<script>

// function pictureFromPath(file, dispatch) {
// 	if (file == null) return;
// 	let reader = new FileReader();
// 	reader.addEventListener("load", () => {
// 		let image = elt("img", {
// 			onload: () => dispatch({
// 				picture: pictureFromImage(image)
// 			}),
// 			src: reader.result
// 		});
// 	});
// 	reader.readAsDataURL(file);
// }
let imageWrapper = document.querySelector(".imageWrapper");

let canvasContainer = document.querySelector("#canvas-container");

let scale = 3;

let state = {
	tool: "draw",
	color: "#000000",
	picture: undefined,
	done: [],
	doneAt: 0,
	scale: scale
};

<% if (picPath) { %>
	state.bgPic = document.querySelector('#pic'); 
<% } %>


// document.querySelector("div").appendChild(startPixelEditor({}));
canvasContainer.appendChild(startPixelEditor({state}));

<% if (motifPath) { %>
	let motif = document.querySelector('#motif');
	let canvas = document.querySelector('canvas');
	console.log(motif.naturalWidth * scale);
	motif.style.width = `${motif.naturalWidth*scale}px`;
	motif.style.height = `${motif.naturalHeight*scale}px`;
	canvas.style.opacity = 0.7;

<% } %>


</script>
</html>